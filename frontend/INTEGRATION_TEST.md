# 前后端联调测试指南

## 前置条件

1. **后端服务运行**
   ```bash
   cd backend
   npm start
   ```
   后端应该运行在 `http://localhost:5000`

2. **前端环境变量配置**
   - 创建 `frontend/.env.local` 文件
   - 配置 `NEXT_PUBLIC_API_BASE_URL=http://localhost:5000`
   - 参考 `ENV_SETUP.md` 文件

3. **前端服务运行**
   ```bash
   cd frontend
   npm run dev
   ```
   前端应该运行在 `http://localhost:3000`

## 测试步骤

### 1. 基础功能测试

1. **打开前端页面**
   - 访问 `http://localhost:3000`
   - 检查页面是否正常加载

2. **测试输入和解析**
   - 在输入框中输入："明天下午3点和老板开会"
   - 点击"解析并添加"按钮
   - 检查是否显示加载状态
   - 验证事件是否成功添加到日历

3. **测试错误处理**
   - 输入空内容，点击解析
   - 应该显示错误提示："请输入日程描述"
   - 输入无效内容（如"asdf"），检查错误提示

### 2. 测试场景功能

1. **点击测试场景按钮**
   - 点击"简单事件"按钮
   - 验证输入框是否自动填充
   - 点击解析，验证是否成功

2. **测试多个场景**
   - 依次测试所有测试场景按钮
   - 验证每个场景都能正确填充和解析

### 3. 日历功能测试

1. **事件显示**
   - 解析成功后，检查日历上是否显示事件
   - 验证事件颜色是否正确（根据分类）

2. **事件点击**
   - 点击日历上的事件
   - 验证是否打开事件详情抽屉
   - 检查详情信息是否正确显示

3. **视图切换**
   - 测试月视图、周视图、日视图切换
   - 验证事件在不同视图下都能正确显示

### 4. 错误处理测试

1. **网络错误**
   - 停止后端服务
   - 尝试解析，应该显示网络错误提示
   - 检查是否显示 suggestion

2. **API 错误**
   - 输入无效的时间描述
   - 检查错误提示是否包含 details 和 suggestion

### 5. 浏览器控制台检查

打开浏览器开发者工具，检查：

1. **API 请求日志**
   - 应该看到 `[API] 请求地址: http://localhost:5000/api/v1/events/parse`
   - 检查请求数据格式是否正确

2. **错误日志**
   - 不应该有未捕获的错误
   - 网络错误应该有友好的提示

## 预期结果

### 成功场景
- ✅ 输入自然语言，成功解析并显示在日历上
- ✅ 事件颜色根据分类正确显示
- ✅ 点击事件显示详细信息
- ✅ 测试场景按钮能正确填充输入框
- ✅ 错误提示友好且包含建议

### 失败场景处理
- ✅ 网络错误显示友好提示
- ✅ API 错误显示 details 和 suggestion
- ✅ 输入验证错误及时提示

## 常见问题排查

### 1. CORS 错误
- 检查后端 CORS 配置
- 确认后端 `app.js` 中已启用 CORS 中间件

### 2. 404 错误
- 检查 API 地址是否正确
- 确认后端服务正在运行
- 检查环境变量配置

### 3. 事件不显示
- 检查浏览器控制台错误
- 验证 API 响应格式
- 检查 FullCalendar 事件格式转换

### 4. 时区问题
- 检查 `getContext()` 函数是否正确生成时区
- 验证时间格式是否为 ISO 8601

## 完成标准

所有测试通过后，前后端联调成功！

